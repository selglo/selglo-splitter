name: Split Stats Image

on:
schedule:
- cron: '0 8 * * *' # Ø§Ø¬Ø±Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø³Ø§Ø¹Øª 08:00 UTC
workflow_dispatch: # Ø§Ù…Ú©Ø§Ù† Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ Ù‡Ù… Ø¨Ø±Ø§ÛŒ ØªØ³Øª

jobs:
split:
runs-on: ubuntu-latest

steps:
- name: Checkout splitter repo
uses: actions/checkout@v3
with:
submodules: true # Ø¯Ø±ÛŒØ§ÙØª ÙØ§ÛŒÙ„ 001.png Ø§Ø² Ø±ÛŒÙ¾ÙˆÛŒ stats

- name: Setup Node.js
uses: actions/setup-node@v3
with:
node-version: 20

- name: Install canvas dependencies
run: |
sudo apt-get update
sudo apt-get install -y libcairo2-dev libjpeg-dev libpango1.0-dev libgif-dev build-essential g++

- name: Install npm packages
run: npm install

- name: Run splitter script
run: node scripts/splitter.mjs --input=stats/daily/clothing/women/001.png

- name: Commit results
run: |
git config --global user.name "github-actions"
git config --global user.email "actions@github.com"
git add daily/clothing/women/sliced/
git commit -m "ğŸ–¼ï¸ Auto-split images"
git push
