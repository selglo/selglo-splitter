# .github/workflows/splitter.yml
# Ø§ÛŒÙ† ÙØ§ÛŒÙ„ GitHub ActionsØŒ Ù‡Ø± Ø±ÙˆØ² Ø³Ø§Ø¹Øª 08:00 UTC Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯
# Ùˆ Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ÙØ§ÛŒÙ„ splitter.mjsØŒ ØªÙ…Ø§Ù… ØªØµØ§ÙˆÛŒØ± Ù…ÙˆØ¬ÙˆØ¯ Ø¯Ø± daily/clothing/women/ Ø±Ø§ Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø¨Ø±Ø´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

name: split

on:
  schedule:
    - cron: '0 8 * * *'  # Ø§Ø¬Ø±Ø§ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡ Ø³Ø§Ø¹Øª 08:00 UTC
  workflow_dispatch:     # Ø§Ø¬Ø§Ø²Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ø¯Ø³ØªÛŒ

jobs:
  run-split:
    runs-on: ubuntu-latest

    steps:
      # ğŸ“¦ Ø¯Ø±ÛŒØ§ÙØª Ø³ÙˆØ±Ø³ Ø§ØµÙ„ÛŒ (selglo-splitter)
      - name: Checkout splitter repo
        uses: actions/checkout@v3
        with:
          submodules: true         # ÙØ¹Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ submodule
          fetch-depth: 1

      # ğŸ”§ Ù†ØµØ¨ Node.js Ù†Ø³Ø®Ù‡ Û²Û°
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      # ğŸ“š Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ canvas
      - name: Install canvas dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y build-essential libcairo2-dev libpango1.0-dev libjpeg-dev libgif-dev librsvg2-dev

      # ğŸ“¦ Ù†ØµØ¨ Ù¾Ú©ÛŒØ¬â€ŒÙ‡Ø§ÛŒ npm
      - name: Install npm packages
        run: npm install

      # âœ‚ï¸ Ø§Ø¬Ø±Ø§ÛŒ ÙØ§ÛŒÙ„ splitter.mjs
      - name: Run splitter script
        run: node scripts/splitter.mjs

      # âœ… Ú©Ø§Ù…ÛŒØª Ùˆ Ù¾ÙˆØ´ Ù†Ù‡Ø§ÛŒÛŒ ØªØµØ§ÙˆÛŒØ± Ø¨Ø±Ø´ Ø®ÙˆØ±Ø¯Ù‡
      - name: Commit results
        run: |
          git config --global user.name "github-actions"
          git config --global user.email "actions@github.com"
          git add docs/clothing/women/
          git commit -m "ğŸ” Auto-split images from daily/clothing/women"
          git push
